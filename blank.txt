

if(user logs in with google successfully){

    if(there is a session existing){

        if(session's user has a google_email){
            if(google_email is equal to the email google auth returns){
                remain logged in. success.
            }else{
                log out of current account.

                if(account is found with google_email equivalent to the email google auth returns){
                    log in to account with google_email being the email returned from google auth. success
                }else{
                    create new account with google_email being the email returned from google auth. success.
                }
            }
        }else{
            ask user to verify password.

            if(user verifies correct password){
                set user's google_email to the email google auth returns. user remains logged in to same account. success.
            }else{
                unauthorized. rejected.
            }
        }

    }else{

        if(account is found with google_email equivalent to email google auth returns){

            log in to account with google_email the email returned from google auth. success.

        }else if(account is found with regular email equal to email google auth returns){
            ask user to verify password.

            if(user verifies correct password){
                set user's google_email to the email google auth returns. user remains logged in to same account. success.
            }else{
                unauthorized. rejected.
            }
        }else{
            create new account with google_email the email returned from google auth. success.
        }

    }

}


if(user logs in with email and password){

    if(account exists with google_email equal to the input){
        if(there is a password and password is correct){
            logged in successfully to account with google_email. success. 
        }else{
            invalid login. rejected.
        }
    }else{
        account does not exist. rejected.
    }
}


if(user signs up with email and password){
    if(account exists with regular email or google_email equal to the input){
        account already exists. rejected.
    }else{
        create account.
    }
}




NOTES
- do not tell user if account DNE or password is wrong in ERROR messages

- eventually need to replace email with SUB id comparisons